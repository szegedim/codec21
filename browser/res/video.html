<html>
<head>
    <style>
        #video {
            border: 1px solid #999;
            width: 98%;
            max-width: 860px;
        }

        #log {
            width: 25rem;
            height: 15rem;
            border: 1px solid black;
            padding: 0.5rem;
            overflow: scroll;
        }
    </style>
</head>
<body>
<p>
    This can show the selected part of your display including the camera stream.
    Click the Join button to begin.
</p>

<p>
    <button id="start">Join</button>&nbsp;<button id="stop">
    Stop Capture
</button>
</p>

<video id="video" autoplay></video>
<br />

<canvas id="canvas">

</canvas>
<strong>Log:</strong>
<br />
<pre id="log"></pre>
<script>
    const videoElem = document.getElementById("video");
    const logElem = document.getElementById("log");
    const startElem = document.getElementById("start");
    const stopElem = document.getElementById("stop");

    const displayMediaOptions = {
        video: {
            displaySurface: "window",
        },
        audio: false,
    };

    // Set event listeners for the start and stop buttons
    startElem.addEventListener(
        "click",
        (evt) => {
            startCapture();
        },
        false
    );

    stopElem.addEventListener(
        "click",
        (evt) => {
            stopCapture();
        },
        false
    );

    async function startCapture() {
        logElem.innerHTML = "";

        try {
            videoElem.srcObject = await navigator.mediaDevices.getDisplayMedia(
                displayMediaOptions
            );
            dumpOptionsInfo();
        } catch (err) {
            console.error(err);
        }
    }

    function stopCapture(evt) {
        let tracks = videoElem.srcObject.getTracks();

        tracks.forEach((track) => track.stop());
        videoElem.srcObject = null;
    }

    function dumpOptionsInfo() {
        const videoTrack = videoElem.srcObject.getVideoTracks()[0];

        console.log("Track settings:");
        console.log(JSON.stringify(videoTrack.getSettings(), null, 2));
        console.log("Track constraints:");
        console.log(JSON.stringify(videoTrack.getConstraints(), null, 2));
    }

    setInterval(function () {
        let canvas = document.getElementById('canvas');
        let video = document.getElementById('video');

        canvas.width = 1920;
        canvas.height = 1080;

        let ctx = canvas.getContext('2d');
        ctx.drawImage( video, 0, 0, canvas.width, canvas.height );

        let image = canvas.toDataURL('image/jpeg');
    }, 10000)
</script>
</body>
</html>

<!-- Reference https://developer.mozilla.org/en-US/docs/Web/API/Screen_Capture_API/Using_Screen_Capture-->